<?xml version="1.0"?>
<h:html xmlns="http://www.w3.org/2002/xforms" xmlns:h="http://www.w3.org/1999/xhtml"
        xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xsd="http://www.w3.org/2001/XMLSchema"
        xmlns:jr="http://openrosa.org/javarosa" xmlns:orx="http://openrosa.org/xforms"
        xmlns:odk="http://www.opendatakit.org/xforms">
  <h:head>
    <h:title>Show locations selected from map in form on form submission map</h:title>
    <model odk:xforms-version="1.0.0">
      <itext>
        <translation lang="English (en)">
          <text id="places-0">
            <value>HR Giger Museum</value>
          </text>
          <text id="places-1">
            <value>K2</value>
          </text>
          <text id="/data/selection/place:label">
            <value>Place</value>
          </text>
          <text id="/data/selection/point:label">
            <value>The read-only coordinates of the place:</value>
          </text>
        </translation>
        <translation lang="French (fr)">
          <text id="places-0">
            <value>Le musée H.R. Giger</value>
          </text>
          <text id="places-1">
            <value>Le mont K2</value>
          </text>
          <text id="/data/selection/place:label">
            <value>Lieu</value>
          </text>
          <text id="/data/selection/point:label">
            <value>Les coordonnées du lieu (lecture seulement):</value>
          </text>
        </translation>
      </itext>
      <instance>
        <data id="map-internal-select-localized-form-map" version="2022041801">
          <selection>
            <place/>
            <point/>
          </selection>
          <meta>
            <instanceID/>
          </meta>
        </data>
      </instance>
      <instance id="places">
        <root>
          <item>
            <itextId>places-0</itextId>
            <name>giger_museum</name>
            <geometry>46.5841618 7.0801379 0 0</geometry>
            <description>Such art! So much wow!</description>
            <annual_visits>40000</annual_visits>
          </item>
          <item>
            <itextId>places-1</itextId>
            <name>k2</name>
            <geometry>35.880508260751576 76.51505715762721 0 0</geometry>
            <description>Such tall! Much wow!</description>
            <annual_visits>1000</annual_visits>
          </item>
        </root>
      </instance>
      <bind nodeset="/data/selection/place" type="string"/>
      <bind nodeset="/data/selection/point" type="geopoint"
            calculate="instance('places')/root/item[name= /data/selection/place ]/geometry" readonly="true()"/>
      <bind nodeset="/data/meta/instanceID" type="string" readonly="true()" jr:preload="uid"/>
    </model>
  </h:head>
  <h:body>
    <group appearance="field-list" ref="/data/selection">
      <select1 ref="/data/selection/place" appearance="map">
        <label ref="jr:itext('/data/selection/place:label')"/>
        <itemset nodeset="instance('places')/root/item[true()]">
          <value ref="name"/>
          <label ref="jr:itext(itextId)"/>
        </itemset>
      </select1>
      <input ref="/data/selection/point">
        <label ref="jr:itext('/data/selection/point:label')"/>
      </input>
    </group>
  </h:body>
</h:html>
